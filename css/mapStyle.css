/* 基本布局 */
* { box-sizing:border-box; }
html { background:linear-gradient(135deg, #2c3e50 0%, #34495e 100%); min-height:100vh; }
body { margin:0; padding:0; background:transparent; }
.map-page { font-family: "Noto Serif SC", serif; color: #222; background:transparent; min-height:100vh; display:flex; flex-direction:column; }
.map-header { 
  display:flex; justify-content:space-between; align-items:center; padding:20px 32px; 
  background:linear-gradient(135deg, #8b0000 0%, #c41e3a 50%, #990000 100%); 
  color:#fff; box-shadow:0 8px 32px rgba(0,0,0,0.2); 
  border-bottom:4px solid #ffd700;
}
.map-header h1 { margin:0; font-size:28px; letter-spacing:1px; text-shadow:0 2px 8px rgba(0,0,0,0.3); }
.map-header .mode-indicator { font-size:14px; opacity:0.9; }
.map-main { 
  display:flex; gap:24px; padding:28px; flex:1; 
  background:linear-gradient(to bottom, rgba(255,255,255,0.02) 0%, rgba(0,0,0,0.03) 100%);
}
.map-container { flex:1; display:flex; justify-content:center; align-items:center; }
.china-map { 
  width:900px; max-width:100%; height:600px; 
  background-image:url('../img/5.jpg');
  background-size:cover;
  background-position:center;
  background-repeat:no-repeat;
  border-radius:16px; border:2px solid #d4a574; 
  position:relative; 
  box-shadow:
    0 20px 60px rgba(0,0,0,0.25),
    inset 0 1px 0 rgba(255,255,255,0.5);
  overflow:hidden;
}
.china-map::before {
  content:'';
  position:absolute;
  top:0; left:0; right:0; bottom:0;
  background:rgba(0,0,0,0.08);
  pointer-events:none;
  z-index:0;
}
.china-map .china-svg { width:100%; height:100%; display:block; position:relative; z-index:1; }
.china-object { width:100%; height:100%; display:block; border:0; position:relative; z-index:1; }

/* 内部容器，便于缩放整个地图与标记 */
.china-inner { position:relative; width:100%; height:100%; transform-origin:50% 50%; z-index:2; }
.china-inner > .china-object, .china-inner > .route-layer { position:absolute; left:0; top:0; width:100%; height:100%; }

/* 路线层（可在 svg 上绘制 path） */
.route-layer { position:absolute; left:0; top:0; width:100%; height:100%; pointer-events:none; z-index:1; }

/* 标记样式 */
.marker { 
  position:absolute; width:46px; height:46px; border-radius:50%; 
  display:flex; align-items:center; justify-content:center; color:#fff; font-weight:700; 
  cursor:pointer; transform:translate(-50%,-50%); 
  box-shadow:0 8px 20px rgba(0,0,0,0.25), inset 0 2px 4px rgba(255,255,255,0.4);
  transition:transform .2s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow .2s ease, filter .2s ease;
  border:2px solid rgba(255,255,255,0.8);
  z-index:10;
}
.marker.unlocked { 
  background:linear-gradient(135deg, #ff8c00 0%, #ffb84d 50%, #ffa500 100%); 
  box-shadow:0 12px 32px rgba(255,140,0,0.35), inset 0 2px 4px rgba(255,255,255,0.5);
}
.marker.locked { 
  background:linear-gradient(135deg, rgba(100,100,100,0.6) 0%, rgba(80,80,80,0.6) 100%);
  opacity:0.6; 
}
.marker:hover { transform:translate(-50%,-50%) scale(1.12); filter:brightness(1.15); }
.marker .padlock { font-size:14px; }

.marker .label { 
  position:absolute; top:24px; left:50%; 
  transform:translateX(-50%); 
  background:linear-gradient(135deg, rgba(255,255,255,0.98) 0%, rgba(240,240,240,0.98) 100%);
  color:#333; padding:8px 12px; border-radius:8px; 
  font-size:13px; white-space:nowrap; display:none; 
  box-shadow:0 8px 24px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.8);
  border:1px solid rgba(200,200,200,0.5);
  font-weight:500;
  z-index:20;
  animation:labelAppear .2s ease;
}
@keyframes labelAppear { 
  from { opacity:0; transform:translateX(-50%) translateY(-4px); }
  to { opacity:1; transform:translateX(-50%) translateY(0); }
}
.marker:hover .label { display:block; }

/* 解锁脉冲 */
.marker.unlocked::after{ 
  content:''; position:absolute; left:50%; top:50%; width:46px; height:46px; 
  transform:translate(-50%,-50%); border-radius:50%; 
  box-shadow:0 0 0 0 rgba(255,165,0,0.5); 
  animation: pulse 2s ease-out infinite; 
  pointer-events:none; 
}
@keyframes pulse{ 
  0%{ box-shadow:0 0 0 0 rgba(255,165,0,0.5); }
  50%{ box-shadow:0 0 0 12px rgba(255,165,0,0.2); }
  100%{ box-shadow:0 0 0 24px rgba(255,165,0,0); }
}

.map-sidebar { 
  width:340px; background:linear-gradient(135deg, #fff 0%, #f8f8f8 100%); 
  border-left:3px solid #d4a574; padding:24px; 
  box-shadow:-8px 0 24px rgba(0,0,0,0.12);
  border-radius:0 12px 12px 0;
}
.map-sidebar h3 { 
  margin-top:0; margin-bottom:16px; 
  font-size:18px; color:#8b0000; 
  letter-spacing:0.5px; border-bottom:2px solid #ffd700; padding-bottom:8px;
}
.map-sidebar ul { list-style:none; padding:0; margin:0; }
.map-sidebar li { 
  padding:10px 8px; border-bottom:1px solid #f0f0f0; 
  display:flex; justify-content:space-between; align-items:center;
  transition:all .2s ease;
  border-radius:4px;
}
.map-sidebar li:hover { background:rgba(255,165,0,0.05); }
.map-sidebar li.locked { color:#999; font-weight:normal; }
.map-sidebar li button { 
  padding:5px 12px; font-size:12px; border:1px solid #d4a574; 
  background:#fff; color:#8b0000; border-radius:4px; cursor:pointer;
  transition:all .2s ease;
}
.map-sidebar li button:hover { background:#ff8c00; color:#fff; border-color:#ff8c00; }
.map-sidebar li button:disabled { opacity:0.5; cursor:not-allowed; }

.map-footer { 
  padding:16px 32px; display:flex; gap:16px; align-items:center;
  background:linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
  box-shadow:0 -4px 12px rgba(0,0,0,0.1);
  border-top:2px solid #ffd700;
}
.map-footer button, .map-footer a { 
  padding:8px 16px; border:1px solid #ffd700; color:#fff; 
  background:linear-gradient(135deg, #8b0000 0%, #c41e3a 100%);
  text-decoration:none; border-radius:4px; cursor:pointer; 
  transition:all .2s ease; font-weight:500;
}
.map-footer button:hover, .map-footer a:hover { 
  background:linear-gradient(135deg, #c41e3a 0%, #ff6b6b 100%);
  box-shadow:0 4px 12px rgba(255,107,107,0.3);
  transform:translateY(-2px);
}
#modeIndicator { font-size:13px; padding:4px 12px; background:rgba(255,255,255,0.2); border-radius:20px; }

/* 响应 */
@media (max-width:1100px){ 
  .map-main { flex-direction:column; } 
  .map-sidebar { width:100%; border-left:none; border-top:3px solid #d4a574; border-radius:0; }
  .china-map { width:100%; max-width:800px; }
}
